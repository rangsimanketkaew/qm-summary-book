% LaTeX source for ``Summary of Quantum Chemistry''
% Copyright (c) 2023 รังสิมันต์ เกษแก้ว (Rangsiman Ketkaew).

\chapter{พลังงานรวมของโมเลกุล}

\section{[เกริ่นนำ]}

เอกสารชุดนี้จริง ๆ แล้วจะเรียกว่าเป็นหนังสือก็ไม่ได้เพราะว่าเป็นการสรุปเนื้อของเคมีควอนตัมทั้งหมดโดย%
เน้นไปที่อธิบายภาพรวมของทฤษฎีและวิธีการคำนวณต่าง ๆ ของโครงสร้างเชิงอิเล็กทรอนิกส์ (Electron 
Structure) ของโมเลกุล โดยในส่วนแรกของเอกสารชุดนี้นั้นจะเกี่ยวข้องกับเคมีควอนตัมและส่วนที่สองจะ%
พูดถึงการจำลองโมเลกุลแบบเอ็มพิริคัล ถ้าให้ขยายความก็คือส่วนแรกนั้นจะเน้นไปที่การสรุปและอธิบายการ%
ใช้ฟังก์ชันคลื่นของอิเล็กตรอนและพลังงานของระบบซึ่งคุณสมบัติเกือบทั้งหมดของโมเลกุล (โมเลกุลเดี่ยว ๆ) 
ยั้ยสามารถคำนวณได้โดยการใช้วิธีทางเคมีควอนตัม แต่ว่าถ้าเป็นระบบที่มีหลาย ๆ โมเลกุลแล้วเราต้องการ%
คำนวณคุณสมบัติที่อุณหภูมิที่แน่นอนนั้นเราจะต้องใช้วิธีพิเศษที่เรียกว่าการจำลองแบบ Dynamics เข้ามาช่วย%
ซึ่งจะเกี่ยวข้องกับการคำนวณเอนโทรปีของระบบนั่นเอง สำหรับการจำลอง Dynamics นั้นสามารถทำได้ 2 
วิธีคือใช้การจำลอง Molecular Dynamics กับ Monte Carlo ซึ่งทั้งสองวิธีนี้ผมจะอธิบายในส่วนที่สอง%
ของเอกสาร

\section{Total energy}

ก่อนที่จะเข้าสู่เนื้อหาที่เราจะต้องไปเจอกับฟังก์ชันคลื่นหรือ Wavefunction และสมการชโรดิงเงอร์หรือ 
Schrodinger equation นั้นผมอยากให้มาทำความเข้าใจกับพลังงานรวมของอะตอมกันก่อน เริ่มต้นก็คือเรา%
จะทำการ assume ว่าอิเล็กตรอนนั้นจะมีสภาวะปกติที่สภาวะพื้นหรือ Ground state ซึ่งพลังงานรวมของมัน%
นั้นจะขึ้นอยู่กับ Atomic coordinates

\begin{equation}
    E^{el}_{tot}(R_{1}, \dots, R_{N})
\end{equation}

โดย ณ จุด ๆ นี้เราจะนำการประมาณแบบแรกเข้ามาใช้เพื่อทำให้การแก้สมการของเรานั้นทำได้ง่ายขึ้นซึ่ง%
วิธีการประมาณนั้นก็คือ Born-Oppenheimer approximation นั้นเองโดยเป็นการ assume ว่าสำหรับ%
มุมมองของอิเล็กตรอนนั้น นิวเคลียสก็คือเป็นเพียงแค่จุด ๆ หนึ่งเท่านั้นเอง ซึ่ง approximation อันนี้มี%
ประโยชน์มาก ๆ เพราะว่ามันช่วยทำให้ชีวิตเราง่ายขึ้นในการศึกษาหรือคำนวณคุณสมบัติเชิงอิเล็กทรอนิกส์%
ต่าง ๆ ของอะตอมอื่น ๆ ที่มีอิเล็กตรอนมากกว่า 1 ตัว

นอกจากพลังงานรวมแล้วเรายังสามารถคำนวณแรงที่กระทำต่ออะตอมแต่ละตัวในโมเลกุลได้ด้วยโดยการหา%
อนุพันธ์อันดับที่ 1 ของพลังงานรวมเทียบกับ atomic coordinate ของอะตอมนั้น ๆ ที่เราสนใจ ซึ่งเรา%
สามารถหาได้โดยได้ผลเฉลยแบบตรงไปตรงมาหรือจะใช้วิธี Numerical method ก็ได้

สำหรับอัลกอริทึมที่เรานำมาใช้ในการปรับโครงสร้างของโมเลกุลหรือ Minimization algorithms 
นั้นมีเยอะมาก ๆ โดยการปรับโครงสร้างของโมเลกุลนั้นก็คือเราทำการหาจุดที่ต่ำที่สุดในพื้นผิวพลังงานศักย์%
ซึ่ง ณ จุด ๆ นั้นโมเลกุลจะมีพลังงานที่ต่ำที่สุด อย่างไรก็ตามบ่อยครั้งเรามักจะมีโมเลกุลที่มี Local minima 
หลายอัน สำหรับโมเลกุลเล็ก ๆ หรือโมเลกุลที่มีโครงสร้างไม่ซับซ้อนนั้นเราสามารถหาจุด minima ได้ง่าย%
เมื่อเทียบกับโมเลกุลที่มีขนาดใหญ่ พูดง่าย ๆ คือเมื่อโมเลกุลมีขนาดที่ใหญ่ขึ้นจำนวน local minima นั้นก็จะ%
มากขึ้นตามไปด้วย โดยหนึ่งในตัวอย่างที่น่าสนใจก็คือสำหรับโมเลกุลหรือคลัสเตอร์ที่มี 55 อะตอมนั้นสามารถมี%
จำนวน minima ได้มากถึง $10^{21}$ เลยทีเดียว

\section{ความถี่ (Frequencies)}

Vibrational frequencies สามารถคำนวณได้จากพลังงานรวมเชิงอะตอม โดย vibration นั้นจะได้%
จากการคำนวณอนุพันธ์อันดับ 2 ของพลังงานรวมเทียบกับ atomic coordinates ของอะตอมคู่ในโมเลกุล%
ซึ่งสามารถทำได้โดยใช้วิธี finite difference 

\section{Transition states}

ในความเป็นจริงนั้นคุณสมบัติต่าง ๆ ที่เกี่ยวข้องกับโครงสร้างของโมเลกุลนั้นสามารถคำนวณได้จาก atomic 
total energy โดยคุณสมบัติอันหนึ่งที่น่าสนใจมาก ๆ ก็คือ chemical reactivity หรือความว่องไว%
ในการทำปฏิิกิริยา โดยค่าคงที่สมดุลของปฏิกิริยาและอัตราการเกิดปฏิริยานั้นสามารถคำนวณได้ง่าย ๆ แต่ว่า%
ผลการคำนวณนั้นจะไม่ค่อยแม่นยำมากนัก สำหรับปฏิริยาเคมีนั้นสารตั้งต้นจะมีโครงสร้างของโมเลกุลที่ค่อนข้าง%
แน่นอนเพราะว่ามักจะเป็นโครงสร้างที่มีพลังงานต่ำที่สุด แต่ว่าโครงสร้างของ transition states 
นั้นจะมี geometry ที่ต่างออกไป โดยกรณีทั่ว ๆ ไปนั้นโมเลกุลที่ไม่เป็นเส้นตรงนั้นจะมี degree of 
freedom คือ $3N - 6$ แต่ว่าจะมี transition state ได้เพียงแค่ geometry เดียวเท่านั้น 
(ระหว่าง reaction และ product) ถ้าหากว่า minima ของ reaction กับ product นั้นอยู่ห่างกัน%
มาก ๆ ก็อาจจะมี transition state หลายอันก็ได้ซึ่งก็หมายความว่ปฏิกิริยานั้นมี Intermediates 
เกิดขึ้นระหว่าง reactant และ product นั่นเอง 

ประเด็นที่สำคัญอีกอันก็คือพลังงานที่เกี่ยวข้องกับปฏิกิริยาเคมีนั้นไม่ใช่พลังงานแต่ว่าเป็นพลังงานอิสระหรือ 
$F = H - TS$ ดังนั้นเราจึงต้องทำการประมาณค่า entropy ของระบบนั่นเอง สำหรับโมเลกุลที่อยู่ใน 
Gas phase และโมเลกุลที่อยู่บน Surface สามารถทำได้ไม่ยาก (เราแค่ต้องคำนวณ Molecular 
vibration ออกมา) แต่ว่าโมเลกุลที่อยู่ในของเหลวหรือ liquid นั้นทำได้ยาก

อัลกอริทึมที่ใช้ในการคำนวณหาโครงสร้างของ Transition state นั้นมีความซับซ้อนกว่าอัลกอริทึมของการทำ 
Minimization เยอะมาก ๆ โดยเรามีวิธีหลาย ๆ วิธีด้วยกันหนึ่งในนั้นก็ึคิอ Nudge Elastic Band (NEB) 
สำหรับวิธี NEB นั้นก็คือเราใช้ไอเดียของ reaction path ที่เป็นการเชื่อมโยงจุดหลาย ๆ จุดเข้าด้วยกัน 
ในทางปฏิบัตินั้นพลังงานที่เราคำนวณนั้นจะเป็นพลังงาน ไม่ใช่พลังงานอิสระ

ในการคำนวณ NEB นั้นเราจะคิดว่ามีสปริงที่เชื่อมระหว่างจุดโดยสปริงแต่ละอันจะมีค่าคงที่หรือความแข็งของ%
สปริงเท่ากับค่า ๆ หนึ่ง คราวนี้เราจะต้องทำการ minimize พลังงานของ path ทั้งหมดโดยที่จุดที่ทั้งสองด้าน%
นั้นจะถูกตรึงไว้ ตามหลักการนั้น (ตามอุดมคติ) path เริ่มต้นหรือ original path นั้นจะถูกปรับและขยับ%
เข้าใกล้กับ path ที่ถูกต้องของปฏิกิริยามากขึ้นเรื่อย ๆ ถ้าหากว่าผู้อ่านสนใจศึกษารายละเอียดเเพิ่มเติมของ 
NEB ลองอ่านได้ที่ \url{http://www.openmx- square.org/tech_notes/NEB.pdf}

จริง ๆ แล้วสิ่งที่วิธี NEB ทำนั้นก็คือไม่ได้เป็นการหา Transition state ที่ถูกต้องมากซะทีเดียวนักแต่ว่า%
เป็นการใช้ Polynomial interpolation สำหรับการประมาณค่าเพื่อให้ผลที่สมเหตุสมผล 

โดยทั่วไปนั้นการหา Transition state นั้นไม่ได้สามารถได้ง่าย ๆ จึงได้มีการพัฒนาวิธีการอื่น ๆ ขึ้นมารวม%
ไปถึงปรับปรุงให้ NEB นั้นให้ผลที่ถูกต้องมากขึ้น แต่สิ่งที่เราควร note ไว้ก็คือ NEB นั้นให้พลังงานรวมออกมา
ไม่ใช่พลังงานอิสระ ดังนั้นถ้าเราต้องการคำนวณพลังงานอิสระปฏิกิริยาเคมีเราจะต้องคำนวณ Entropy 
ของระบบแยกต่างหาก แล้วก็วิธี NEB มีความสิ้นเปลืองและกินเวลามาก ๆ เพราะว่าจุดแต่ละจุดใน path 
ที่ถูกกำหนดขึ้นมานั้นจะเป็นการคำนวณด้วยวิธี Quantum mechanics พร้อม ๆ กัน 

โดยสรุปก็คือ NEB นั้นเป็นหนึ่งในหลายวิธี ๆ ที่ใช้ในการหา Transition state หรือ TS search 
แล้วก็การใช้ NEB ไม่ง่ายเท่าไหร่สำหรับผู้ที่เริ่มต้นศึกษาเคมีคำนวณแล้วก็พลังงานที่เราได้ออกมานั้นเป็นพลังงานรวม 
ไม่ใช่พลังงานอิสระ 

\section{Potential energy surface}

สิ่งที่ตรงไปตรงมาที่เราใช้ในการอธิบานพลังงานรวมของโมเลกุลมากที่สุดนั้นก็คือพื้นผิวพลังงานศักย์หรือ Potential 
energy surface (PES) โดยกรณีทั่วไปเกือบทั้งหมดนั้นจริง ๆ แล้ว PES ก็คือ Atomic total energy 
นั่นเอง แล้วก็เนื่องจากว่า Total energy นั้นเป็นพารามิเตอร์หรือปริมาณที่มีมิติสูง (High dimensional) 
ดังนั้น PES approach นั้นจึงทำได้ค่อนข้างลำบากและยากในทางปฏิบัติแม้แต่กรณีง่าย ๆ เช่นโมเลกุลที่มีอะตอม%
เพียงแค่สองอะตอมเองก็ตาม โดย Coordinate space นั้นมีจำนวนมิติถึง 6 มิติ ถ้าหากว่าเราใช้ 10 จุด%
ในแต่ละมิติก็เท่ากับว่าเราจะต้องทำการคำนวณทั้งหมด $10^{6}$ เพื่อทำการ map PES อันนี้ จริง ๆ แล้ว%
ตัวเลขมันฟังดูเยอะแต่ว่าในทางปฏิบัตินั้นทำได้แต่ว่าทำได้สำหรับระบบเล็กเท่านั้น (ไม่ได้สำหรับระบบใหญ่ ๆ)
โดย PES แบบสมบูรณ์หรือ Full PES นั้นไม่ค่อยได้รับความนิยมในการคำนวณมากนักเพราะว่ามันสิ้นเปลือง%
แต่ว่าก็พอมีประโยชน์อยู่บ้าง

\section{สรุป}

โดยสรุปก็ึคือ Atomic total energy นั้นเป็นปริมาณที่มีประโยชน์มาก ๆ เพราะว่ามันเป็นกุญแจที่เราสามารถ%
ใช้ในการคำนวณหาปริมาณอื่น ๆ ที่เราสนใจได้เยอะเลย เช่น โครงสร้างเชิงโมเลกุล, โหมดการสั่น, 
พลังงานรวมของระบบ รวมไปถึงการประมาณค่าของ Reaction barriers แต่สิ่งที่ยังเป็นปัญหาหรือข้อจำกัด%
ก็คือเรามักจะต้องการ Free energy มากกว่า Total energy นั่นเอง 
